(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0aeb2f45"],{2636:function(t,e,i){"use strict";i("fc26")},9197:function(t,e,i){"use strict";i.d(e,"b",(function(){return s})),i.d(e,"c",(function(){return n})),i.d(e,"d",(function(){return r})),i.d(e,"e",(function(){return o})),i.d(e,"f",(function(){return l})),i.d(e,"a",(function(){return c}));var a=i("b775");function s(){return Object(a["a"])({url:"/admin/paper/queryAll",method:"get"})}function n(t){return Object(a["a"])({url:"/admin/paper/queryPage",method:"get",params:t})}function r(t){return Object(a["a"])({url:"/admin/paper/removePaper",method:"delete",data:t})}function o(t){return Object(a["a"])({url:"/admin/paper/removePapers",method:"delete",data:t})}function l(t){return Object(a["a"])({url:"/admin/paper/savePaper",method:"post",data:t})}function c(t){return Object(a["a"])({url:"/admin/paper/getPaper",method:"get",params:t})}},c031:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"app-container"},[i("el-drawer",{attrs:{title:"添加题目",visible:t.drawerVisable,size:"70%","wrapper-closable":!1,"destroy-on-close":!0},on:{"update:visible":function(e){t.drawerVisable=e}}},[t.drawerVisable?i("QuestionList",{attrs:{son:!0,"type-id":t.curTypeId,"exclude-id-list":t.excludeIdList},on:{"close-event":t.handlerAddResult}}):t._e()],1),i("el-dialog",{attrs:{title:"随机抽题",visible:t.dialogVisible,width:"500px"},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("el-form",{attrs:{model:t.form,"label-width":"80px"}},[i("el-form-item",{attrs:{label:"选择题库"}},[i("el-select",{attrs:{placeholder:"请选择题库",clearable:""},on:{change:t.repoChange},model:{value:t.form.repoId,callback:function(e){t.$set(t.form,"repoId",e)},expression:"form.repoId"}},t._l(t.repoData,(function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1),i("el-form-item",{attrs:{label:"选择章节"}},[i("el-select",{attrs:{placeholder:"请选择章节",clearable:""},model:{value:t.form.chapterId,callback:function(e){t.$set(t.form,"chapterId",e)},expression:"form.chapterId"}},t._l(t.chapterData,(function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1),i("el-form-item",{attrs:{label:"题目数量"}},[i("el-input",{attrs:{type:"number",max:"100",min:"0",placeholder:"请输入题目数量"},model:{value:t.form.quantity,callback:function(e){t.$set(t.form,"quantity",e)},expression:"form.quantity"}})],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:t.submitRandomForm}},[t._v("确 定")])],1)],1),i("el-row",{attrs:{gutter:10}},[i("el-col",{ref:"leftObject",style:t.styleObj,attrs:{span:5}},[i("el-card",[i("p",[t._v("试卷名称："),i("el-input",{staticStyle:{width:"60%"},model:{value:t.paperData.name,callback:function(e){t.$set(t.paperData,"name",e)},expression:"paperData.name"}})],1),i("p",[t._v("创建的人："+t._s(t.paperData.creatorName))]),i("p",[t._v("题目总数："),i("span",{staticClass:"number"},[t._v(t._s(t.paperData.questionCount))]),t._v(" 题")]),i("p",[t._v("题目总分："),i("span",{staticClass:"number"},[t._v(t._s(t.paperData.totalScore))]),t._v(" 分")]),i("p",[t._v("及格分数："),i("el-input",{staticStyle:{width:"70px"},attrs:{type:"number",size:"mini"},model:{value:t.paperData.qualifyScore,callback:function(e){t.$set(t.paperData,"qualifyScore",e)},expression:"paperData.qualifyScore"}}),t._v(" 分")],1),i("el-button",{staticStyle:{width:"47%"},attrs:{type:"danger",size:"mini"},on:{click:function(e){return t.$router.push({name:"Paper"})}}},[t._v("返回")]),i("el-button",{staticStyle:{width:"47%"},attrs:{type:"primary",size:"mini"},on:{click:t.handlerSave}},[t._v("保存")]),t._l(5,(function(e,a){return i("div",{key:a},[i("el-divider",[i("el-button",{attrs:{type:"text"},on:{click:function(e){return t.jumpTypeCard(a)}}},[t._v(t._s(t.typeInfo[a].name))])],1),i("div",[t._v(" 共有 "),i("span",{staticClass:"number"},[t._v(t._s(t.typeInfo[a].count))]),t._v(" 题， 共有 "),i("span",{staticClass:"number"},[t._v(t._s(t.typeInfo[a].score))]),t._v(" 分， 设置每题"),i("el-input",{staticStyle:{width:"70px"},attrs:{type:"number",size:"mini"},on:{change:function(e){return t.handlerEach(a)}},model:{value:t.typeInfo[a].eachScore,callback:function(e){t.$set(t.typeInfo[a],"eachScore",e)},expression:"typeInfo[i].eachScore"}}),t._v("分 ")],1)],1)}))],2)],1),i("el-col",{attrs:{span:18,offset:6}},t._l(t.questionList,(function(e,a){return i("el-card",{key:a,ref:"typeCard",refInFor:!0,style:0!==a?"margin-top: 20px":null},[i("div",{attrs:{slot:"header"},slot:"header"},[i("span",[t._v(t._s(t.typeInfo[a].name))]),i("el-button",{staticStyle:{float:"right",padding:"3px 0","margin-left":"10px"},attrs:{type:"text"},on:{click:function(e){return t.handlerRandomQuestion(a)}}},[t._v("随机抽题")]),i("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:function(e){return t.handlerAddQuestion(a)}}},[t._v("添加题目")])],1),t._l(e,(function(e,s){return i("div",{key:e.id},[i("el-row",[i("el-col",{attrs:{span:20}},[i("div",[i("el-tag",{attrs:{effect:"dark",size:"medium"}},[t._v(t._s(s+1))]),i("span",{staticClass:"question-content"},[t._v(t._s(e.content))])],1),null!=e.image?i("el-image",{staticStyle:{height:"100px","margin-top":"10px"},attrs:{fit:"contain",src:e.image,"preview-src-list":[e.image]}}):t._e(),0==a||1==a?i("div",t._l(e.options,(function(e,a){return i("div",{key:e.id,class:1==e.isRight?"optionIsRight":"optionNotRight"},[i("div",[t._v(t._s(String.fromCharCode(65+a))+". "+t._s(e.content))]),null!=e.image?i("el-image",{staticStyle:{height:"100px","margin-top":"10px"},attrs:{fit:"contain",src:e.image,"preview-src-list":[e.image]}}):t._e()],1)})),0):t._e(),2==a?i("div",[i("div",{class:"true"==e.answer?"optionIsRight":"optionNotRight"},[t._v(" 正确 ")]),i("div",{class:"false"==e.answer?"optionIsRight":"optionNotRight"},[t._v(" 错误 ")])]):t._e(),3==a||4==a?i("div",[i("div",{staticClass:"grayback-box"},[i("div",[t._v("题目答案："+t._s(e.answer))]),null!=e.answerImage?i("el-image",{staticStyle:{height:"100px","margin-top":"10px"},attrs:{fit:"contain",src:e.answerImage,"preview-src-list":[e.answerImage]}}):t._e()],1)]):t._e(),i("div",{staticClass:"grayback-box"},[i("div",[t._v("题目解析："+t._s(e.analysis))]),null!=e.analysisImage?i("el-image",{staticStyle:{height:"100px","margin-top":"10px"},attrs:{fit:"contain",src:e.analysisImage,"preview-src-list":[e.analysisImage]}}):t._e()],1)],1),i("el-col",{attrs:{span:4,align:"center"}},[i("div",{staticStyle:{"margin-top":"20px"}},[i("el-button",{attrs:{type:"success",size:"small",icon:"el-icon-top",circle:""},on:{click:function(e){return t.handleUp(a,s)}}}),i("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-bottom",circle:""},on:{click:function(e){return t.handleDown(a,s)}}}),i("el-button",{attrs:{type:"danger",size:"small",icon:"el-icon-delete",circle:""},on:{click:function(e){return t.handleRemove(a,s)}}})],1),i("div",{staticStyle:{"margin-top":"20px"}},[t._v(" 本题 "),i("el-input",{staticStyle:{width:"70px"},attrs:{type:"number",size:"mini"},model:{value:e.score,callback:function(i){t.$set(e,"score",i)},expression:"question.score"}}),t._v(" 分 ")],1)])],1),i("el-divider")],1)}))],2)})),1)],1)],1)},s=[],n=i("5530"),r=(i("b0c0"),i("a434"),i("2b0e")),o=i("2f62"),l=i("2525"),c=i("31cb"),u=i("1e0a"),p=i("9197"),d=i("8310"),h={name:"PaperForm",components:{QuestionList:u["default"]},data:function(){return{styleObj:{position:"fixed",top:"70px"},drawerVisable:!1,dialogVisible:!1,form:{repoId:null,chapterId:null,quantity:0},repoData:[],chapterData:[],curTypeId:1,excludeIdList:[],paperData:{id:null,name:"",creator:null,creatorName:null,questionCount:0,totalScore:0,qualifyScore:0},typeInfo:[{name:"单选题",count:0,score:0,isEach:!1,eachScore:null},{name:"多选题",count:0,score:0,isEach:!1,eachScore:null},{name:"判断题",count:0,score:0,isEach:!1,eachScore:null},{name:"填空题",count:0,score:0,isEach:!1,eachScore:null},{name:"简答题",count:0,score:0,isEach:!1,eachScore:null}],questionList:[[],[],[],[],[]]}},computed:Object(n["a"])({},Object(o["b"])(["id","name","roles","avatar"])),watch:{questionList:{immediate:!0,deep:!0,handler:function(){for(var t=0,e=0,i=0;i<this.questionList.length;i++){for(var a=0,s=0;s<this.questionList[i].length;s++)a+=parseFloat(this.questionList[i][s].score);this.typeInfo[i].count=this.questionList[i].length,this.typeInfo[i].score=a,t+=parseFloat(this.typeInfo[i].count),e+=parseFloat(this.typeInfo[i].score)}this.paperData.questionCount=t,this.paperData.totalScore=e}},id:{immediate:!0,handler:function(){this.paperData.creator=this.id}},name:{immediate:!0,handler:function(){this.paperData.creatorName=this.name}}},created:function(){var t=this;Object(l["e"])().then((function(e){t.repoData=e.data})),this.paperData.id=this.$route.params.id,null!=this.paperData.id&&Object(p["a"])({paperId:this.paperData.id}).then((function(e){200===e.status&&(t.paperData=e.data.paper,t.questionList=e.data.paperQuestionListList)}))},mounted:function(){window.addEventListener("scroll",this.handleScroll);for(var t=0;t<5;t++)null!=this.questionList[t]&&this.questionList[t].size>0&&(this.typeInfo[t].eachScore=this.questionList[t][0].score)},beforeDestroy:function(){window.removeEventListener("scroll",this.handleScroll)},methods:{repoChange:function(){var t=this;this.form.chapterId=null,null==this.form.repoId||""===this.form.repoId?this.chapterData=null:Object(c["a"])({repoId:this.form.repoId}).then((function(e){t.chapterData=e.data}))},handleScroll:function(){var t=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop;"70px"===this.styleObj.top&&t>55?this.styleObj.top="20px":"20px"===this.styleObj.top&&t<55&&(this.styleObj.top="70px")},jumpTypeCard:function(t){window.scrollTo(0,this.$refs.typeCard[t].$el.offsetTop)},handlerEach:function(t){for(var e=0;e<this.questionList[t].length;e++)this.questionList[t][e].score=this.typeInfo[t].eachScore},handleRemove:function(t,e){this.questionList[t].splice(e,1)},handleUp:function(t,e){if(0!==e){var i=this.questionList[t][e-1];r["default"].set(this.questionList[t],e-1,this.questionList[t][e]),r["default"].set(this.questionList[t],e,i),this.$message.success("上移成功")}else this.$message.warning("已经是第一行了，不能上移")},handleDown:function(t,e){if(e!==this.questionList[t].length-1){var i=this.questionList[t][e+1];r["default"].set(this.questionList[t],e+1,this.questionList[t][e]),r["default"].set(this.questionList[t],e,i),this.$message.success("下移成功")}else this.$message.warning("已经是最后一行了，不能下移")},handlerAddQuestion:function(t){this.curTypeId=t,this.excludeIdList=[];for(var e=0;e<this.questionList.length;e++)for(var i=0;i<this.questionList[e].length;i++)this.excludeIdList.push(this.questionList[e][i].questionId);this.drawerVisable=!0},handlerRandomQuestion:function(t){this.curTypeId=t,this.excludeIdList=[];for(var e=0;e<this.questionList.length;e++)for(var i=0;i<this.questionList[e].length;i++)this.excludeIdList.push(this.questionList[e][i].questionId);this.dialogVisible=!0},handlerAddResult:function(t){this.drawerVisable=!1,console.log(t);for(var e=0;e<t.length;e++){var i=t[e];r["default"].set(i,"score",1),r["default"].set(i,"questionId",i.id),i.id=null,this.questionList[this.curTypeId].push(i)}},handlerSave:function(){var t=this;Object(p["f"])({paper:this.paperData,paperQuestionListList:this.questionList}).then((function(e){200===e.status?t.$message.success("保存成功"):t.$message.error(e.message)}))},submitRandomForm:function(){var t=this;Object(d["b"])({repoId:this.form.repoId,chapterId:this.form.chapterId,quantity:this.form.quantity,typeId:this.curTypeId,excludeIdList:this.excludeIdList}).then((function(e){200===e.status?(t.$message.success("获取成功"),t.handlerAddResult(e.data),t.dialogVisible=!1):t.$message.error(e.message)}))}}},f=h,m=(i("2636"),i("2877")),v=Object(m["a"])(f,a,s,!1,null,"4be47bf2",null);e["default"]=v.exports},fc26:function(t,e,i){}}]);